[#include "../../inc/head_v2.html"/]
<link rel="stylesheet" type="text/css" href="${base}/res/css/wmes_console.css">
<link href="${base}/res/console/css/bootstrap-3.3.4.css" rel="stylesheet" type="text/css">
<link href="${base}/res/console/css/css.css" rel="stylesheet" type="text/css">
<style>
.ifa_choose_condition {height: auto;}
.form-horizontal .form-group{margin-right: -15px; margin-left: -15px; height: 30px;}
.wmes-logo {
    height: 60px;
    padding: 5px;
    margin: 0 auto;
    top: 0px;
    background: #464342;
    text-align: center;
    position: fixed;
    width: 80px;
    z-index: 1000000;
}
.wmes-contentbox {
    background: #ffffff;
    padding-top: 5px;
}
</style>

<div class="wmes-content" id="wmes_wraper" >
	<div class="ifa_choose_condition">
		<div class="wmes-wrap-title" style="height:16px;">
			<p>[@lang_res k='distributor.form.title'/]</p>
		</div>
	</div>
         <form class="form-horizontal" id="frm" method="post">
         	  <input type="hidden" id="id" name="id" value="${(distributor.id)?if_exists}">
              <div class="form-group">
                  <div class="col-md-3 text-right">
                      <label for="txtLoginCode" class="label-control">[@lang_res k='distributor.form.name'/]</label>
                  </div>
                  <div class="col-md-7">
                      <input id=txtCompanyName type="text" class="form-control " name="companyName" value="${(distributor.companyName)?if_exists}">
                  </div>
              </div>
              <div class="form-group">
                  <div class="col-md-3 text-right">
                      <label for="selEntitytype" class="label-control">[@lang_res k='distributor.form.entityType'/]</label>
                  </div>
                  <div class="col-md-7">
                      <select id="selEntitytype" class="form-control" name="entityType">
                          <option value='1'>[@lang_res k='entityType.option.1'/]</option>
                          <option value='2'>[@lang_res k='entityType.option.2'/]</option>
                          <option value='3'>[@lang_res k='entityType.option.3'/]</option>
                          <option value='4'>[@lang_res k='entityType.option.4'/]</option>
                          <option value='5'>[@lang_res k='entityType.option.5'/]</option>
                       </select> 
                  </div>
                </div>
                <div class="form-group">
                    <div class="col-md-3 text-right">
                        <label for="txtLoginCode" class="label-control">[@lang_res k='distributor.form.registerNo'/]</label>
                    </div>
                    <div class="col-md-7">
                        <input id=txtRegisterNo type="text" class="form-control " name="registerNo" value="${(distributor.registerNo)?if_exists}">
                    </div>
                </div>
                <div class="form-group">
                    <div class="col-md-3 text-right">
                        <label for="txtLoginCode" class="label-control">[@lang_res k='distributor.form.isFinancial'/]</label>
                    </div>
                    <div class="col-md-7">
                      <select id="selIsFinancial" class="form-control" name="isFinancial">
                                <option value='1'>[@lang_res k='global.true'/]</option>
                                <option value='0'>[@lang_res k='global.false'/]</option>

                         </select>   
                    </div>
                </div>
                <div class="form-group">
                    <div class="col-md-3 text-right">
                        <label for="txtLoginCode" class="label-control">[@lang_res k='distributor.form.giin'/]</label>
                    </div>
                    <div class="col-md-7">
                        <input id=txtGiin type="text" name="giin" class="form-control " value="${(distributor.giin)?if_exists}">
                    </div>
                </div>
                <div class="form-group">
                    <div class="col-md-3 text-right">
                        <label for="txtLoginCode" class="label-control">[@lang_res k='distributor.form.naturePurpose'/]</label>
                    </div>
                    <div class="col-md-7">
                        <input id="txtNaturePurpose" type="text" name="naturePurpose" class="form-control " value="${(distributor.naturePurpose)?if_exists}">
                    </div>
                </div>
                <div class="form-group">
                    <div class="col-md-3 text-right">
                        <label for="txtLoginCode" class="label-control">[@lang_res k='distributor.form.incorporationDate'/]</label>
                    </div>
                    <div class="col-md-7">
                        <input id="dtIncorporationDate" name="incorporationDate" type="text" class="laydate-icon form-control form-control-laydate" style="height: 34px;padding: 6px 12px;" onclick="laydate({istime: false, format: 'YYYY-MM-DD'})" value="${(distributor.incorporationDate?string('yyyy-MM-dd'))?if_exists}">
                    </div>
                </div>
                <div class="form-group">
                    <div class="col-md-3 text-right">
                        <label for="txtLoginCode" class="label-control">[@lang_res k='distributor.form.incorporationPlace'/]</label>
                    </div>
                    <div class="col-md-7">
                        <select id="selIncorporationPlace" class="form-control" name="incorporationPlace">
                         </select>  
                    </div>
                </div>
                <div class="form-group">
                    <div class="col-md-3 text-right">
                        <label for="txtLoginCode" class="label-control">[@lang_res k='distributor.form.registeredAddress'/]</label>
                    </div>
                    <div class="col-md-7">
                        <input id="txtRegisteredAddress" name="registeredAddress" type="text" class="form-control " value="${(distributor.registeredAddress)?if_exists}">
                    </div>
                </div>
                <div class="form-group">
                    <div class="col-md-3 text-right">
                        <label for="txtLoginCode" class="label-control">[@lang_res k='distributor.form.mailingAddress'/]</label>
                    </div>
                    <div class="col-md-7">
                        <input id="txtMailingAddress" type="text" class="form-control" name="mailingAddress" value="${(distributor.mailingAddress)?if_exists}">
                    </div>
                </div>
                <div class="form-group">
                    <div class="col-md-3 text-right">
                        <label for="txtLoginCode" class="label-control">[@lang_res k='distributor.form.country'/]</label>
                    </div>
                    <div class="col-md-7">
                        <select id="selCountry" class="form-control" name="country">
                         </select>  
                    </div>
                </div>
                <div class="form-group">
                    <div class="col-md-3 text-right">
                        <label for="txtLoginCode" class="label-control">[@lang_res k='distributor.form.website'/]</label>
                    </div>
                    <div class="col-md-7">
                        <input id="txtWebsite" type="text" name="website" class="form-control " value="${(distributor.website)?if_exists}">
                    </div>
                </div>
                 <div class="text-center pd10">
            	<button type="submit" id="btnSave" class="btn-blue-s" >
					[@lang_res k='global.save'/]
				</button>
				<!-- 
                <a href="javascript:void(0);" onclick="javascript:closeTab();" class="btn-blue-s2">[@lang_res l=Session["_LANG_CODE_"] k='global.close'/]</a>
            	 -->
            </div>
      </form>
           
</div>

<script src="${base}/res/console/js/jquery-1.11.2.min.js" type="text/javascript"></script>
<script src="${base}/res/console/js/bootstrap.js" type="text/javascript"></script>
<script src="${base}/res/third/bootstrap/js/bootstrapValidator.js"></script>
<script src="${base}/res/console/js/jquery.form.js"></script>
<script src="${base}/res/console/js/js.js" type="text/javascript"></script>
<script src="${base}/res/third/layer/layer.js"></script>
<script src="${base}/res/js/util.js"></script>
<script src="${base}/res/third/laydate/laydate.js"></script>
<script type="text/javascript">
seajs.use(['jquery','layer'], function($){
		//先gen出国家数据
		loadCountry();
		//保存公司信息
		//$('#btnSave').on('click',savefrom);//按钮是subit类型，会自动提交。
		//gen出国家数据
		function loadCountry()
		{
			$.ajax({
	            type: "post",
	            url : "${base}/console/country/langListJson.do.do?datestr="+ new Date().getTime(),
	            data: {},
	            dataType: "json",
	            success: function (json, textStatus) {
	               if (json != undefined && json.result == true) {
						var data = JSON.parse(json.countryJson);
						var html = "";
						$.each(data, function(i, n) {
							html += "<option value='"+n.id+"'>" + n.name + "</option>";
						});
						 $('#selIncorporationPlace').empty().append(html);
				  		 $('#selCountry').empty().append(html);
					}
	            }
        	});
		}
		
		//表单验证
		$('#frm').bootstrapValidator({
			feedbackIcons : {
				valid : 'glyphicon glyphicon-ok',
				invalid : 'glyphicon glyphicon-remove',
				validating : 'glyphicon glyphicon-refresh'
			},
			fields : {
				companyName : {
					validators : {
						notEmpty : {
							message : "[@lang_res k='distributor.form.name'/] [@lang_res k='global.empty.tip'/]"
						}
					}
				},
				registerNo : {
					validators : {
						notEmpty : {
							message : "[@lang_res k='distributor.form.registerNo'/] [@lang_res k='global.empty.tip'/]"
						}
					}
				},
				incorporationPlace : {
					validators : {
						notEmpty : {
							message : "[@lang_res k='distributor.form.incorporationPlace'/] [@lang_res k='global.empty.tip'/]"
						}
					}
				},
				registeredAddress:{
					validators : {
						notEmpty : {
							message : "[@lang_res k='distributor.form.registeredAddress'/] [@lang_res k='global.empty.tip'/]"
						}
					}
				}
			}
		}).on('success.form.bv', function(e) {
			e.preventDefault();
			savefrom();
		});
		//保存
		function savefrom() {
		/*
			var id = $('#id').val();
			var companyName = $('#txtCompanyName').val();
			var entityType = $('#selEntitytype').find('option:selected').val();
			var registerNo = $('#txtRegisterNo').val();
			var isFinancial = $('#selIsFinancial').val();
			var giin = $('#txtGiin').val();
			var incorporationPlace = $('#selIncorporationPlace').find('option:selected').val();
			var registeredAddress = $('#txtRegisteredAddress').val();
			var mailingAddress = $('#txtMailingAddress').val();
			var naturePurpose = $('#txtNaturePurpose').val();
			var country = $('#selCountry').find('option:selected').val();
			var website = $('#txtWebsite').val();
			var incorporationDate = $('#dtIncorporationDate').val();*/
			//var postData = { 'id':id,'companyName': companyName, 'entityType': entityType, 'registerNo': registerNo, 'isFinancial': isFinancial, 'giin': giin, 'incorporationPlace': incorporationPlace, 'registeredAddress': registeredAddress, 'mailingAddress': mailingAddress, 'country': country,'naturePurpose':naturePurpose,'website':website}; 
        	var postData = $("#frm").serialize();
        	$.ajax({
	            type: "post",
	            url : "${base}/console/distributor/saveInfo.do?datestr="+ new Date().getTime(),
	            data: postData,
	            dataType: "json",
	            success: function (data, textStatus) {
	               var result = data.result;
	               if(result==true){ 
	               		layer.msg("[@lang_res k='global.success.save'/]", { time: 2000 });
	               		$('#btnSave').attr('disabled','disabled');
	               }else layer.alert("[@lang_res k='global.failed.save'/]", { time: 2000 });
	            }
	            /*,error: function(XMLHttpRequest, textStatus, errorThrown) {
                    alert(XMLHttpRequest.status);
                    alert(XMLHttpRequest.readyState);
                    alert(textStatus);
                }*/
        	});
		}
		
});
	
</script>
